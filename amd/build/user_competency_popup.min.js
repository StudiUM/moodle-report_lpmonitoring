define(["jquery","core/notification","core/str","core/ajax","core/templates","tool_lp/dialogue"],function(a,b,c,d,e,f){var g=function(b,c){this._regionSelector=b,this._userCompetencySelector=c,this._competencyId=null,this._planId=null,this._userId=null,a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};return g.prototype._handleClick=function(c){c.preventDefault();var e=this,f=a(c.target).closest(this._userCompetencySelector);e._competencyId=a(f).data("competencyid"),e._planId=a(f).data("planid"),e._userId=a(f).data("userid");var g=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_plan",args:{competencyid:e._competencyId,planid:e._planId},done:e._contextLoaded.bind(e),fail:b.exception}]);g[0].then(function(a){var c="core_competency_user_competency_viewed_in_plan";a.plan.iscompleted&&(c="core_competency_user_competency_plan_viewed"),d.call([{methodname:c,args:{competencyid:e._competencyId,userid:e._userId,planid:e._planId},fail:b.exception}])})},g.prototype._contextLoaded=function(a){var d=this;e.render("tool_lp/user_competency_summary_in_plan",a).done(function(a,g){c.get_string("usercompetencysummary","report_competency").done(function(b){d.popup=new f(b,a,e.runTemplateJS.bind(e,g),d._refresh.bind(d),(!0))}).fail(b.exception)}).fail(b.exception)},g.prototype.popup=null,g.prototype.close=function(){this.popup.close(),this.popup=null},g.prototype._refresh=function(){},g});