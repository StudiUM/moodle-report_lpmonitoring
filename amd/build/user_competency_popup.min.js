define ("report_lpmonitoring/user_competency_popup",["jquery","core/notification","core/str","core/ajax","core/templates","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){var h=function(b,c){this._regionSelector=b;this._userCompetencySelector=c;this._competencyId=null;this._planId=null;this._userId=null;a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};h.prototype._handleClick=function(c){c.preventDefault();var e=this,f=a(c.target).closest(this._userCompetencySelector);e._competencyId=a(f).data("competencyid");e._planId=a(f).data("planid");e._userId=a(f).data("userid");var g=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_plan",args:{competencyid:e._competencyId,planid:e._planId},fail:b.exception}]);g[0].then(function(a){e._contextLoaded.bind(e)(a,f);var c="core_competency_user_competency_viewed_in_plan";if(a.plan.iscompleted){c="core_competency_user_competency_plan_viewed"}d.call([{methodname:c,args:{competencyid:e._competencyId,userid:e._userId,planid:e._planId},fail:b.exception}])})};h.prototype._contextLoaded=function(a,d){var h=this;return c.get_string("usercompetencysummary","report_competency").done(function(b){return f.create({type:f.types.DEFAULT,title:b,body:e.render("tool_lp/user_competency_summary_in_plan",a),large:!0},d).done(function(a){h.popup=a;h.popup.getRoot().on(g.hidden,function(){h.focusContentItem(d);h._refresh()});h.popup.show()}.bind(this))}).fail(b.exception)};h.prototype.focusContentItem=function(a){if(a.is("input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]")){a.focus()}else{a.find("input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]").first().focus()}};h.prototype.popup=null;h.prototype.close=function(){this.popup.destroy();this.popup=null};h.prototype._refresh=function(){};return h});
//# sourceMappingURL=user_competency_popup.min.js.map
