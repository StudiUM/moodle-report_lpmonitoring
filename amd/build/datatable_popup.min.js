define(["jquery","core/notification","core/str","core/ajax","core/templates","tool_lp/dialogue"],function(a,b,c,d,e,f){var g=function(b,c){a(b).on("click",c,this._handleClick.bind(this))};return g.prototype._handleClick=function(c){c.preventDefault();var e=a(c.target),f=a(e).data("competencyid"),g=a(e).data("elementid"),h=a(e).data("userid"),i=a(e).data("type");if("cm"==i)var j=d.call([{methodname:"tool_cmcompetency_data_for_user_competency_summary_in_coursemodule",args:{userid:h,competencyid:f,cmid:g}},{methodname:"tool_cmcompetency_user_competency_viewed_in_coursemodule",args:{userid:h,competencyid:f,cmid:g}}]);else var j=d.call([{methodname:"report_lpmonitoring_data_for_user_competency_summary_in_course",args:{userid:h,competencyid:f,courseid:g}},{methodname:"report_lpmonitoring_user_competency_viewed_in_course",args:{userid:h,competencyid:f,courseid:g}}]);a.when.apply(a,j).then(function(a){this._contextLoaded.bind(this)(a)}.bind(this))["catch"](b.exception)},g.prototype._contextLoaded=function(a){var d=this;a.displayuser=!0,a.usercompetencysummary.cangrade=!1;var g="tool_lp/user_competency_summary_in_course";"undefined"!=typeof a.coursemodule&&(g="report_cmcompetency/user_competency_summary_in_coursemodule"),e.render(g,a).done(function(a,g){c.get_string("usercompetencysummary","report_competency").done(function(b){new f(b,a,e.runTemplateJS.bind(e,g),d.destroyDialogue,(!0))}).fail(b.exception)}).fail(b.exception)},g.prototype.destroyDialogue=function(a){a.close()},g});