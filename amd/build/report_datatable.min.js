define(["jquery","report_lpmonitoring/paginated_datatable","report_lpmonitoring/jquery.dataTables"],function(a,b){var c=function(c,d,e,f,g,h,i,j){this.tableSelector=c,this.reportfilterName=d,this.searchSelector=e,this.searchColumnsSelector=f,this.reportScaleSelector=g,this.coursesSelector=h,this.activitiesSelector=i,this.columns=[];var k=this;a(document).ready(function(){b.apply(k.tableSelector,!1,!1);var d=[""];a(k.tableSelector+" thead tr th").each(function(b){if(b>1){var e=b+1;a(c+" tbody tr td:nth-of-type("+e+")").each(function(){var b=a(this).text().trim();if(d.indexOf(b)==-1){var c="";b===j&&(c='selected="true"'),a(k.reportScaleSelector).append('<option value="'+b+'"'+c+">"+b+"</option>"),d.push(b)}}),k.columns.push(b)}}),a(k.reportScaleSelector).on("change",function(){k.performSearch()}),a(k.searchSelector).on("input",function(){k.performSearch()}),a(k.searchColumnsSelector).on("input",function(){k.filterCoulmns(),k.performSearch()}),a("input[type=radio][name="+k.reportfilterName+"]").change(function(){k.courseActivityFilter(),k.performSearch()}),a(c).show(),k.courseActivityFilter(),k.filterCoulmns(),k.performSearch()})};return c.prototype.tableSelector=null,c.prototype.reportfilterName=null,c.prototype.searchSelector=null,c.prototype.searchColumnsSelector=null,c.prototype.reportScaleSelector=null,c.prototype.coursesSelector=null,c.prototype.activitiesSelector=null,c.prototype.columns=[],c.prototype.performSearch=function(){var b=a(this.tableSelector).DataTable();b.search("").columns().search("").draw(),a(this.tableSelector).DataTable().column(0).search(a(this.searchSelector).val(),!1,!1).draw();var c=a(this.reportScaleSelector+" option:selected").val();a(this.tableSelector).DataTable().search(c,!1,!1).draw()},c.prototype.courseActivityFilter=function(){var b=this,c=a("input[type=radio][name="+b.reportfilterName+"]:checked").val(),d="",e=!1;"course"===c?(d="course-cell",e=!0):"module"===c&&(d="cm-cell",e=!0),e?a(b.tableSelector+" thead tr th").each(function(c){if(c>1){var e=a(b.tableSelector).DataTable().column(c),f=e.header(),g=a(this).hasClass(d);a(f).toggleClass("switchsearchhidden",!g),a(this).toggleClass("switchsearchhidden",!g),e.nodes().to$().toggleClass("switchsearchhidden",!g)}}):a.each(b.columns,function(c,d){var e=a(b.tableSelector).DataTable().column(d),f=e.header();a(f).removeClass("switchsearchhidden"),e.nodes().to$().removeClass("switchsearchhidden")})},c.prototype.filterCoulmns=function(){var b=a(this.searchColumnsSelector).val().toLowerCase(),c=this;""!==b?a(c.tableSelector+" thead tr th").each(function(d){if(d<=1)return!0;var e=a(c.tableSelector).DataTable().column(d),f=e.header(),g=a(this).text().toLowerCase().indexOf(b)>-1;a(f).toggleClass("filtersearchhidden",!g),a(this).toggleClass("filtersearchhidden",!g),e.nodes().to$().toggleClass("filtersearchhidden",!g)}):a.each(c.columns,function(b,d){var e=a(c.tableSelector).DataTable().column(d),f=e.header();a(f).removeClass("filtersearchhidden"),e.nodes().to$().removeClass("filtersearchhidden")})},{init:function(a,b,d,e,f,g,h,i){return new c(a,b,d,e,f,g,h,i)}}});