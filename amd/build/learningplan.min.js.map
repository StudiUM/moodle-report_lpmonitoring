{"version":3,"sources":["../src/learningplan.js"],"names":["define","$","templates","ajax","notification","str","Chart","autocomplete","ModalFactory","ModalEvents","Popup","InlineGrader","fieldsettoggler","colorcontrast","DataTable","ResetGradeDialogue","LearningplanReport","userview","cmcompgradingenabled","userView","cmcompgradingEnabled","initPage","colorContrast","init","learningplan","popup","_refresh","self","reloadCompetencyDetail","_competencyId","_userId","_planId","close","templateSelector","on","templateChangeHandler","bind","change","learningplanSelector","learningplanChangeHandler","studentSelector","studentChangeHandler","studentPlansSelector","studentPlansChangeHandler","tagSelector","tagChangeHandler","learningplanTagSelector","learningplanTagChangeHandler","learningplanTagCommentsSelector","changeScaleApplyHandler","changeScaleSortorderHandler","changeScaleHandler","prop","changeDisplayRating","changeWithcommentsHandler","changeWithplansHandler","reloadTagsIfNeeded","prototype","templateId","learningplanId","studentLearningplanId","tagLearningplanId","tagId","userId","templateSelected","studentSelected","competencies","scalesvaluesSelected","scalefilterin","scalesortorder","withcomments","withplans","tagsAreLoading","compDetailActiveTab","e","target","val","data","resetUserUsingLPTemplateSelection","removeClass","hasClass","show","loadScalesFromTemplate","addClass","hide","empty","checkDataFormReady","loadTags","remove","promise","call","methodname","args","then","results","get_string","done","selecttag","append","text","each","index","tag","id","optionExists","length","fail","exp","exception","event","preventDefault","is","tagid","label","oldTagLearningplanId","selectlearningplan","plan","fullname","planname","planid","selectorOption","nolearningplanavailable","trigger","displayrating","visible","canresetdisplayrating","resetDisplayRating","selection","find","nouserselected","templateid","parseInt","context","scales","render","html","js","runTemplateJS","buildLearningplanOptions","options","scaleSelector","key","value","name","userid","conditionByTemplate","conditionStudent","conditionByTag","attr","removeAttr","loadListCompetencies","elementloading","promiselistCompetencies","competencies_list","hascompetencies","loadCompetencyDetail","loadSummaryTab","loadReportTab","element","requests","record","competency","usercompetency","push","competencyid","user","promises","competencydetail","compid","scaleid","tab","cangrade","applyInlineGrader","hasrating","ApplyDonutGraph","hasratingincms","css","apply","promiseCompetenciesReport","reportinfos","checkedvalue","filterchecked_course","filterchecked_module","filterchecked_both","tablesearchvalue","tablesearchvaluecolumn","scalefilterreport","promiseCompetenciesSummary","scaleselected","i","scale_competency","searchvalue","chooserateoption","grader","scalevalues","hasratingincm","forcm","colors","canvasselector","itemsbyscales","scalecompetencyitems","color","nbcm","nbcourse","type","labels","datasets","backgroundColor","hoverBackgroundColor","legend","responsive","tooltips","enabled","submitFormHandler","tagSelected","displayPlan","scalefiltervalues","scalevalue","filterscaleinputs","JSON","stringify","displayEvidencelist","evidences","listevidence","title","create","types","DEFAULT","body","large","modal","getRoot","hidden","destroy","focusContentItem","bodyRendered","displayCourselist","listcourses","listtotalcourses","displayCmlist","listcms","listtotalcms","M","cfg","contextid","usercontext","hasnavigation","navigationclosed","errorcode","displayScaleCourseList","scalecompetencyitem","displayScaleCmList","listitems","item","focus","first","resetGrade","allcompetencies","dialogue","note","display","get_strings","component","strings","enhance","toggleClass","toggle","siblings","closest","t","n","slideToggle","document","stopPropagation","parent","totallistcourses","totallistcms","collapseall","expandall","processResults","selector","users","userplan","_label","transport","query","success","failure","scalefilterapply","ctx","identity","k","hasidentity","join","when","arguments"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Learning plan report navigation.\n *\n * @module     report_lpmonitoring/learningplan\n * @author     Issam Taboubi <issam.taboubi@umontreal.ca>\n * @copyright  2016 Université de Montréal\n */\n\ndefine(['jquery',\n    'core/templates',\n    'core/ajax',\n    'core/notification',\n    'core/str',\n    'core/chartjs',\n    'core/form-autocomplete',\n    'core/modal_factory',\n    'core/modal_events',\n    'report_lpmonitoring/user_competency_popup',\n    'tool_lp/grade_user_competency_inline',\n    'report_lpmonitoring/fieldsettoggler',\n    'report_lpmonitoring/colorcontrast',\n    'report_lpmonitoring/paginated_datatable',\n    'report_lpmonitoring/resetgrade_dialogue'],\n    function($, templates, ajax, notification, str, Chart, autocomplete, ModalFactory, ModalEvents,\n        Popup, InlineGrader, fieldsettoggler,\n        colorcontrast, DataTable, ResetGradeDialogue) {\n\n        /**\n         * Learning plan report.\n         * @param {Boolean} userview True if the report is for user view (student).\n         * @param {Boolean} cmcompgradingenabled True if grading in course module competency is enabled.\n         */\n        var LearningplanReport = function(userview, cmcompgradingenabled) {\n            this.userView = userview || false;\n            this.cmcompgradingEnabled = cmcompgradingenabled || false;\n\n            // Init the form filter.\n            this.initPage();\n\n            // Init the color contrast object.\n            this.colorContrast = colorcontrast.init();\n\n            // Init User competency page popup.\n            var learningplan = this;\n            var popup = new Popup('[data-region=list-competencies-section]', '[data-user-competency=true]');\n            // Override the after show refresh method of the user competency popup.\n            popup._refresh = function() {\n                var self = this;\n                learningplan.reloadCompetencyDetail(self._competencyId, self._userId, self._planId);\n                self.close();\n            };\n\n            $(this.templateSelector).on('change', this.templateChangeHandler.bind(this)).change();\n            $(this.learningplanSelector).on('change', this.learningplanChangeHandler.bind(this)).change();\n            $(this.studentSelector).on('change', this.studentChangeHandler.bind(this)).change();\n            $(this.studentPlansSelector).on('change', this.studentPlansChangeHandler.bind(this)).change();\n            $(this.tagSelector).on('change', this.tagChangeHandler.bind(this)).change();\n            $(this.learningplanTagSelector).on('change', this.learningplanTagChangeHandler.bind(this)).change();\n            $(this.learningplanTagCommentsSelector).on('change', this.learningplanTagChangeHandler.bind(this)).change();\n\n            $('.competencyreport').on('change',\n                '.scalefiltercontainer input[name=\"optionscalefilter\"]',\n                this.changeScaleApplyHandler.bind(this)).change();\n            $('.competencyreport').on('change',\n                '.scalesortordercontainer input[name=\"optionscalesortorder\"]',\n                this.changeScaleSortorderHandler.bind(this)).change();\n            $('.competencyreport').on('change','.scalefiltervalues' ,this.changeScaleHandler.bind(this)).change();\n            $('.competencyreport input[name=optionfilter]').prop(\"disabled\", false);\n            $('.competencyreport input[name=optionscalesortorder]').prop(\"disabled\", false);\n            // Display rating in user plan.\n            $(\".competencyreport\").on(\"change\", \".displayratings input[type=checkbox]\",\n                this.changeDisplayRating.bind(this)).change();\n            // Only plans with comments filter.\n            $('.competencyreport').on('change','#filter-comment' ,this.changeWithcommentsHandler.bind(this)).change();\n            // Only students with at least two plans.\n            $('.competencyreport').on('change','#filter-plan' ,this.changeWithplansHandler.bind(this)).change();\n            // When the tags are modified we reload the tags filter.\n            $(\".competencyreport\").on('DOMSubtreeModified', \".tags-stats\", this.reloadTagsIfNeeded.bind(this));\n            // When the comments is checked we modify the tags filter.\n            // Only plans with comments filter and tags.\n            $('.competencyreport').on('change','#filter-comments',this.reloadTagsIfNeeded.bind(this));\n\n        };\n\n        /** @var {Number} The template ID. */\n        LearningplanReport.prototype.templateId = null;\n        /** @var {Boolean} If report is for user view */\n        LearningplanReport.prototype.userView = false;\n        /** @var {Number} The learning plan ID from template. */\n        LearningplanReport.prototype.learningplanId = null;\n        /** @var {Number} The learning plan ID from student. */\n        LearningplanReport.prototype.studentLearningplanId = null;\n        /** @var {Number} The learning plan ID from tag. */\n        LearningplanReport.prototype.tagLearningplanId = null;\n        /** @var {String} The selected tag ID. */\n        LearningplanReport.prototype.tagId = null;\n        /** @var {Number} The user ID. */\n        LearningplanReport.prototype.userId = null;\n        /** @var {Boolean} If template option is selected. */\n        LearningplanReport.prototype.templateSelected = null;\n        /** @var {Boolean} If student option is selected. */\n        LearningplanReport.prototype.studentSelected = null;\n        /** @var {Array} Competencies informations. */\n        LearningplanReport.prototype.competencies = {};\n        /** @var {String} Scales values filter. */\n        LearningplanReport.prototype.scalesvaluesSelected = null;\n        /** @var {ColorContrast} ColorContrast object instance. */\n        LearningplanReport.prototype.colorcontrast = null;\n        /** @var {String} Apply scale filters on grade in plan, course or course module. */\n        LearningplanReport.prototype.scalefilterin = '';\n        /** @var {String} Apply scale sortorder. */\n        LearningplanReport.prototype.scalesortorder = 'ASC';\n        /** @var {String} Apply filter for only plans with comments. */\n        LearningplanReport.prototype.withcomments = false;\n        /** @var {String} Apply filter for only students with at least two plans. */\n        LearningplanReport.prototype.withplans = false;\n        /** @var {Boolean} Is course module competency grading enabled. */\n        LearningplanReport.prototype.cmcompgradingEnabled = false;\n\n        /** @var {String} The template select box selector. */\n        LearningplanReport.prototype.templateSelector = \"#templateSelectorReport\";\n        /** @var {String} The learning plan select box selector. */\n        LearningplanReport.prototype.learningplanSelector = '#learningplanSelectorReport';\n        /** @var {String} The student selector. */\n        LearningplanReport.prototype.studentSelector = '#studentSelectorReport';\n        /** @var {String} The student plans selector. */\n        LearningplanReport.prototype.studentPlansSelector = '#studentPlansSelectorReport';\n        /** @var {String} The tag select box selector. */\n        LearningplanReport.prototype.tagSelector = \"#tagSelectorReport\";\n        /** @var {String} The learning plan with this tag select box selector. */\n        LearningplanReport.prototype.learningplanTagSelector = '#learningplanTagSelectorReport';\n        /** @var {String} */\n        LearningplanReport.prototype.learningplanTagCommentsSelector = '#filter-comments';\n\n        /** @var {Boolean} Indicate that the tags are currently loading, to prevent loading them twice at the same time. */\n        LearningplanReport.prototype.tagsAreLoading = false;\n\n        /** @var {String} Active tab course or course module. */\n        LearningplanReport.prototype.compDetailActiveTab = null;\n\n        /**\n         * Triggered when a template is selected.\n         *\n         * @name   templateChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.templateChangeHandler = function(e) {\n            var self = this;\n            self.templateId = $(e.target).val();\n            $(self.learningplanSelector).data('templateid', self.templateId);\n            $(self.learningplanSelector).data('scalefilter', '');\n            $(self.learningplanSelector).data('scalesortorder', '');\n            self.resetUserUsingLPTemplateSelection();\n            self.learningplanId = null;\n            if (self.templateId !== '') {\n                $('.competencyreport .moreless-actions').removeClass('hidden');\n                if ($('.competencyreport .show-toggler').hasClass('hidden')) {\n                    $('.competencyreport .advanced').show();\n                }\n                self.loadScalesFromTemplate(self.templateId);\n            } else {\n                $('.competencyreport .moreless-actions').addClass('hidden');\n                $('.competencyreport .advanced').hide();\n                $('.competencyreport #scale').empty();\n            }\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Load the tags list from the webservice.\n         *\n         * @name   loadTags\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.loadTags = function() {\n            var self = this;\n            if(self.tagsAreLoading === false) {\n                self.tagsAreLoading = true;\n                $(self.tagSelector + ' option').remove();\n\n                var promise = ajax.call([{\n                    methodname: 'report_lpmonitoring_search_tags_for_accessible_plans',\n                    args: {\n\n                    }\n                }]);\n\n                promise[0].then(function(results) {\n                    str.get_string('selecttag', 'report_lpmonitoring').done(\n                        function(selecttag) {\n                            $(self.tagSelector).append($('<option>').text(selecttag).val(''));\n\n                            $.each(results, function(index, tag) {\n                                $(self.tagSelector).append($('<option>').text(tag.tag).val(tag.id));\n                            });\n\n                            // Select the option that was selected before.\n                            var optionExists = ( $(self.tagSelector + \" option[value=\" + self.tagId + \"]\").length > 0 );\n                            if(optionExists === true) {\n                                $(self.tagSelector).val(self.tagId);\n                            } else {\n                                self.tagId = null;\n                                self.tagLearningplanId = null;\n                            }\n\n                            // Simulate a change to reload the learning plans associated to the tag.\n                            $(self.tagSelector).change();\n                            self.tagsAreLoading = false;\n                        }\n                    );\n                }).fail(\n                    function(exp) {\n                        notification.exception(exp);\n                        self.tagsAreLoading = false;\n                    }\n                );\n            }\n        };\n\n        /**\n         * Triggered when the tags are modified in a user plan. Reloads the tags filter, if this filter is currently selected.\n         * @name   reloadTagsIfNeeded\n         * @param {Event} event\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.reloadTagsIfNeeded = function(event) {\n            event.preventDefault();\n            if ($('.competencyreport #tag').is(':checked')) {\n                this.loadTags();\n            }\n        };\n\n        /**\n         * Triggered when a tag is selected.\n         *\n         * @name   tagChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.tagChangeHandler = function(e) {\n            var self = this;\n            self.tagId = $(e.target).val();\n            self.withcomments = $(\"#filter-comments\").is(':checked');\n\n            if (self.tagId == '') {\n                self.tagId = null;\n            }\n            var promise = ajax.call([{\n                methodname: 'report_lpmonitoring_search_plans_with_tag',\n                args: {\n                    tagid: self.tagId,\n                    withcomments: self.withcomments\n                }\n            }]);\n\n            promise[0].then(function(results) {\n                var label = '';\n                // Render the options of the select for learning plans.\n                var oldTagLearningplanId = self.tagLearningplanId;\n                $(self.learningplanTagSelector + ' option').remove();\n\n                if (results.length > 0) {\n                    str.get_string('selectlearningplan', 'report_lpmonitoring').done(\n                        function(selectlearningplan) {\n                            $(self.learningplanTagSelector).append($('<option>').text(selectlearningplan).val(''));\n\n                            $.each(results, function(index, plan) {\n                                label = plan.fullname + ' - ' + plan.planname;\n                                $(self.learningplanTagSelector).append($('<option>').text(label).val(plan.planid));\n                            });\n                            $(self.learningplanTagSelector).prop(\"disabled\", false);\n\n                            // Select the option that was selected before.\n                            var selectorOption = self.learningplanTagSelector + \" option[value=\" + oldTagLearningplanId + \"]\";\n                            var optionExists = ( $(selectorOption).length > 0 );\n                            if(optionExists === true) {\n                                $(self.learningplanTagSelector).val(oldTagLearningplanId);\n                                self.tagLearningplanId = oldTagLearningplanId;\n                            } else {\n                                self.tagLearningplanId = null;\n                            }\n                        }\n                    );\n                } else {\n                    $(self.learningplanTagSelector).prop(\"disabled\", true);\n                    str.get_string('nolearningplanavailable', 'report_lpmonitoring').done(\n                        function(nolearningplanavailable) {\n                            $(self.learningplanTagSelector).append($('<option>').text(nolearningplanavailable).val(''));\n                        }\n                    );\n                }\n                $(self.learningplanTagSelector).trigger('change');\n\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Triggered when a student's plan associated to a tag is selected.\n         *\n         * @name   studentPlansChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.learningplanTagChangeHandler = function(e) {\n            var self = this;\n            self.tagLearningplanId = $(e.target).val();\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Set display rating for plan.\n         *\n         * @name   changeDisplayRating\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeDisplayRating = function(e) {\n            var displayrating = 0;\n            if ($(e.target).is( \":checked\" )) {\n                displayrating = 1;\n            }\n            var planid = $(e.target).data('displayrating-plan');\n\n            var promise = ajax.call([{\n                methodname: 'tool_lp_set_display_rating_for_plan',\n                args: {\n                    planid: planid,\n                    visible: displayrating\n                }\n            }, {\n                methodname: 'tool_lp_can_reset_display_rating_for_plan',\n                args: {\n                    planid: planid\n                }\n            }\n            ]);\n\n            promise[0].then(function() {\n                promise[1].then(function(canresetdisplayrating) {\n                    if (displayrating) {\n                        $('.competencyreport .displayratings input[type=checkbox]').prop(\"checked\", true);\n                    } else {\n                        $('.competencyreport .displayratings input[type=checkbox]').prop(\"checked\", false);\n                    }\n                    if (canresetdisplayrating) {\n                        $('.competencyreport .resetdisplayrating').show();\n                    }\n                }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n                );\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Reset display rating for plan.\n         *\n         * @name   resetDisplayRating\n         * @param  {Number} planid\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.resetDisplayRating = function(planid) {\n            var promise = ajax.call([{\n                methodname: 'tool_lp_reset_display_rating_for_plan',\n                args: {\n                    planid: planid\n                }\n            }, {\n                methodname: 'tool_lp_has_to_display_rating',\n                args: {\n                    planid: planid\n                }\n            }\n            ]);\n\n            promise[0].then(function() {\n                promise[1].then(function(displayrating) {\n                    if (displayrating) {\n                        $('.competencyreport .displayratings input[type=checkbox]').prop(\"checked\", true);\n                    } else {\n                        $('.competencyreport .displayratings input[type=checkbox]').prop(\"checked\", false);\n                    }\n                    $('.competencyreport .resetdisplayrating').hide();\n                }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n                );\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Reset the user using learning plan template selection.\n         *\n         * @name   resetUserUsingLPTemplateSelection\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.resetUserUsingLPTemplateSelection = function() {\n            var self = this,\n            autocomplete = $('.competencyreport .templatefilter .form-autocomplete-selection'),\n            selection = autocomplete.find('span[aria-selected=\"true\"]');\n            self.learningplanId = null;\n            if (selection.length) {\n                selection.remove();\n                $(self.learningplanSelector + ' option').remove();\n                str.get_string('nouserselected', 'report_lpmonitoring').done(\n                    function(nouserselected) {\n                        autocomplete.append($('<span>').text(nouserselected));\n                    }\n                );\n            }\n        };\n\n        /**\n         * Load scales from template.\n         *\n         * @name   loadScalesFromTemplate\n         * @param  {Number} templateid\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.loadScalesFromTemplate = function(templateid) {\n            var self = this;\n            var promise = ajax.call([{\n                methodname: 'report_lpmonitoring_get_scales_from_template',\n                args: {\n                    templateid: parseInt(templateid)\n                }\n            }]);\n            promise[0].then(function(results) {\n                var context = {};\n                context.scales = results;\n                context.cmcompgradingenabled = self.cmcompgradingEnabled;\n                templates.render('report_lpmonitoring/scale_filter', context).done(function(html, js) {\n                    $('.competencyreport #scale').html(html);\n                    templates.runTemplateJS(js);\n                });\n                if (results.length > 0) {\n                    $('.competencyreport #scalefilterapply').show();\n                    templates.render('report_lpmonitoring/scale_filter_apply', context).done(function(html, js) {\n                        $('.competencyreport #scalefilter').html(html);\n                        templates.runTemplateJS(js);\n                    });\n                    $('.competencyreport #scalesortorderlabel').show();\n                    templates.render('report_lpmonitoring/scale_filter_sortorder', context).done(function(html, js) {\n                        $('.competencyreport #scalesortorder').html(html);\n                        templates.runTemplateJS(js);\n                    });\n                } else {\n                    $('.competencyreport #scalefilterapply').hide();\n                    $('.competencyreport #scalesortorderlabel').hide();\n                    $('.competencyreport #scalefilter').html('');\n                    $('.competencyreport #scalesortorder').html('');\n                }\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Build options for learning plan.\n         *\n         * @name   buildLearningplanOptions\n         * @param  {Array} options\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.buildLearningplanOptions = function(options) {\n            var self = this;\n            // Reset options scales.\n            $(self.scaleSelector + ' option').remove();\n            $(self.scaleSelector).append($('<option>'));\n\n            $.each(options, function(key, value) {\n                $(self.scaleSelector).append($('<option>').text(value.name).val(value.id));\n            });\n        };\n\n        /**\n         * Triggered when a learning plan is selected.\n         *\n         * @name   learningplanChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.learningplanChangeHandler = function(e) {\n            var self = this;\n            self.learningplanId = $(e.target).val();\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Triggered when a student is selected.\n         *\n         * @name   studentChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.studentChangeHandler = function(e) {\n            var self = this;\n            self.userId = $(e.target).val();\n            if (self.userId !== null) {\n                var promise = ajax.call([{\n                    methodname: 'core_competency_list_user_plans',\n                    args: {\n                        userid: self.userId\n                    }\n                }]);\n\n                promise[0].then(function(results) {\n                    // Reset options learning plans.\n                    $(self.studentPlansSelector + ' option').remove();\n                    if (results.length > 0) {\n                        $(self.studentPlansSelector).prop(\"disabled\", false);\n                        $.each(results, function(key, value) {\n                            $(self.studentPlansSelector).append($('<option>').text(value.name).val(value.id));\n                        });\n                    } else {\n                        $(self.studentPlansSelector).prop(\"disabled\", true);\n                        str.get_string('nolearningplanavailable', 'report_lpmonitoring').done(\n                            function(nolearningplanavailable) {\n                                $(self.studentPlansSelector).append($('<option>').text(nolearningplanavailable).val(''));\n                            }\n                        );\n                    }\n                    $(self.studentPlansSelector).trigger('change');\n                }, notification.exception);\n            }\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Triggered when a student plans is selected.\n         *\n         * @name   studentPlansChangeHandler\n         * @param  {Event} e\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.studentPlansChangeHandler = function(e) {\n            var self = this;\n            self.studentLearningplanId = $(e.target).val();\n            self.checkDataFormReady();\n        };\n\n        /**\n         * Check if we can submit the form.\n         *\n         * @name   checkDataFormReady\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.checkDataFormReady = function() {\n            var self = this,\n                conditionByTemplate = false,\n                conditionStudent = false,\n                conditionByTag = false;\n\n            if (self.userView === false) {\n                conditionByTemplate = $('#template').is(':checked') && $(self.templateSelector).val() !== '';\n                conditionStudent = $('#student').is(':checked') && $(self.studentSelector).val() !== null &&\n                        $('option:selected', $(self.studentSelector)).attr('value') !== undefined &&\n                        $(\"option:selected\", $(self.studentPlansSelector)).attr('value') !== null &&\n                        $(\"option:selected\", $(self.studentPlansSelector)).attr('value') !== undefined &&\n                        $(\"option:selected\", $(self.studentPlansSelector)).attr('value') !== '';\n                conditionByTag = $('#tag').is(':checked') && $(self.tagSelector).val() !== '';\n            } else {\n                conditionStudent = $(self.studentPlansSelector).val() !== null &&\n                        $(self.studentPlansSelector).val() !== '';\n            }\n\n            if (conditionByTemplate || conditionStudent || conditionByTag) {\n                $('#submitFilterReportButton').removeAttr('disabled');\n            } else {\n                $('#submitFilterReportButton').attr('disabled', 'disabled');\n            }\n        };\n\n        /**\n         * Load list of competencies of a specified plan.\n         *\n         * @name   loadListCompetencies\n         * @param  {Object} plan\n         * @param  {Object} elementloading element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.loadListCompetencies = function(plan, elementloading) {\n            var self = this;\n\n            var promiselistCompetencies = ajax.call([{\n                methodname: 'report_lpmonitoring_list_plan_competencies',\n                args: {\n                    id: plan.id\n                }\n            }]);\n            promiselistCompetencies[0].then(function(results) {\n                if (results.length > 0) {\n                    // Get the \"Detail\" tab content.\n                    var competencies = {competencies_list:results, plan:plan, hascompetencies: true};\n                    templates.render('report_lpmonitoring/list_competencies', competencies).done(function(html, js) {\n                        $(\"#listPlanCompetencies\").html(html);\n                        templates.runTemplateJS(js);\n                        self.loadCompetencyDetail(results, plan, elementloading);\n                        $(\"#nav-tabs\").removeClass(\"hidden\");\n                    });\n                } else {\n                    elementloading.removeClass('loading');\n                    templates.render('report_lpmonitoring/list_competencies', {}).done(function(html, js) {\n                        $(\"#listPlanCompetencies\").html(html);\n                        templates.runTemplateJS(js);\n                        $(\"#report-content\").empty();\n                        $(\"#summary-content\").empty();\n                        $(\"#nav-tabs\").addClass(\"hidden\");\n                    });\n                }\n                self.loadSummaryTab(plan);\n                self.loadReportTab(plan);\n            }).fail(\n                function(exp) {\n                    elementloading.removeClass('loading');\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Load competency detail.\n         *\n         * @name  loadCompetencyDetail\n         * @param {Object[]} competencies\n         * @param {Object} plan\n         * @param {Object} element loader\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.loadCompetencyDetail = function(competencies, plan, element) {\n            var requests = [];\n            var self = this;\n\n            $.each(competencies, function(index, record) {\n                // Locally store user competency information.\n                self.competencies[record.competency.id] = {usercompetency:record.usercompetency};\n                requests.push({\n                    methodname: 'report_lpmonitoring_get_competency_detail',\n                    args: {\n                        competencyid: record.competency.id,\n                        userid: plan.user.id,\n                        planid: plan.id\n                    }\n                });\n            });\n\n            var promises = ajax.call(requests);\n            $.each(promises, function(index, promise) {\n                promise.then(function(context) {\n                    // Locally store competency information.\n                    self.competencies[context.competencyid].competencydetail = context;\n                    context.plan = plan;\n                    context.plan.userid = plan.user.id;\n                    context.cmcompgradingenabled = self.cmcompgradingEnabled;\n                    templates.render('report_lpmonitoring/competency_detail', context).done(function(html, js) {\n                        var compid = context.competencyid;\n                        var userid = plan.user.id;\n                        var planid = plan.id;\n                        var scaleid = context.scaleid;\n                        $('#comp-' + compid + ' .x_content').html(html);\n\n                        // Show comptency ratings details tabs.\n                        if (self.compDetailActiveTab === 'incoursemodule') {\n                            $('.detail-comp-tab a[href=\"#tab-incms-content-' + context.competencyid + '\"]').tab('show');\n                        } else {\n                            $('.detail-comp-tab a[href=\"#tab-incourses-content-' + context.competencyid + '\"]').tab('show');\n                        }\n                        if (context.cangrade) {\n                            // Apply inline grader.\n                            self.applyInlineGrader(compid, userid, planid, scaleid);\n                        }\n\n                        // Apply Donut Graph to the competency in courses.\n                        if (context.hasrating !== false) {\n                            self.ApplyDonutGraph(compid, context, false);\n                        }\n\n                        // Apply Donut Graph to the competency in courses modules.\n                        if (context.hasratingincms !== false && self.cmcompgradingEnabled) {\n                            self.ApplyDonutGraph(compid, context, true);\n                        }\n\n                        // If all template are loaded then hide the loader.\n                        if (index === requests.length - 1) {\n                            element.removeClass('loading');\n                            // Show collapse links.\n                            $('.competencyreport .competency-detail a.collapse-link').css('visibility', '');\n                        }\n                        templates.runTemplateJS(js);\n                        self.colorContrast.apply('#comp-' + compid + ' .x_content .tile-stats .badge.cr-scalename');\n                    });\n                });\n            });\n        };\n\n        /**\n         * Load the report tab.\n         *\n         * @param {Object} plan\n         * @function\n         */\n        LearningplanReport.prototype.loadReportTab = function(plan) {\n            var learningplan = this;\n            // Get the \"Report\" tab content.\n            var promiseCompetenciesReport = ajax.call([{\n                methodname: 'report_lpmonitoring_list_plan_competencies_report',\n                args: {\n                    id: plan.id\n                }\n            }]);\n            promiseCompetenciesReport[0].then(function(results) {\n                if (results['competencies_list'].length > 0) {\n                    var competencies = {reportinfos:results, plan:plan, hascompetencies: true};\n\n                    // Keep the filter and search values.\n                    var checkedvalue = $('input[type=radio][name=reportfilter]:checked').val();\n                    if (checkedvalue == 'course') {\n                        competencies.filterchecked_course = true;\n                    } else if (checkedvalue == 'module') {\n                        competencies.filterchecked_module = true;\n                    } else {\n                        competencies.filterchecked_both = true;\n                    }\n\n                    competencies.tablesearchvalue = $('#table-search-competency').val();\n                    competencies.tablesearchvaluecolumn = $('#table-search-columns').val();\n                    competencies.scalefilterreport = $('#scale-filter-report option:selected').val();\n\n                    // Render the \"Report\" data table template.\n                    templates.render('report_lpmonitoring/datatable', competencies).done(function(html, js) {\n                        $(\"#report-content\").html(html);\n                        templates.runTemplateJS(js);\n                        var popup = new Popup('[data-region=report-competencies-section]', '[data-user-competency=true]');\n                        // Override the after show refresh method of the user competency popup.\n                        popup._refresh = function() {\n                            var self = this;\n                            learningplan.reloadCompetencyDetail(self._competencyId, self._userId, self._planId);\n                            self.close();\n                        };\n                    });\n                } else {\n                    var competencies = {hascompetencies: false};\n                    templates.render('report_lpmonitoring/datatable', competencies).done(function(html, js) {\n                        $(\"#report-content\").html(html);\n                        templates.runTemplateJS(js);\n                    });\n                }\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Load the summary tab.\n         *\n         * @param {Object} plan\n         * @function\n         */\n        LearningplanReport.prototype.loadSummaryTab = function(plan) {\n            var learningplan = this;\n\n            // Get the \"Summary\" tab content.\n            var promiseCompetenciesSummary = ajax.call([{\n                methodname: 'report_lpmonitoring_list_plan_competencies_summary',\n                args: {\n                    id: plan.id\n                }\n            }]);\n            promiseCompetenciesSummary[0].then(function(results) {\n                if (results['scale_competency'].length > 0) {\n                    var competencies = {reportinfos:results, plan:plan, hascompetencies: true};\n\n                    // Keep the filter and search values.\n                    var checkedvalue = $('input[type=radio][name=summaryfilter]:checked').val();\n                    if (checkedvalue == 'course') {\n                        competencies.filterchecked_course = true;\n                    } else if (checkedvalue == 'module') {\n                        competencies.filterchecked_module = true;\n                    } else {\n                        competencies.filterchecked_both = true;\n                    }\n\n                    var scaleselected = $('#scale-filter-summary').val();\n                    for (var i = 0; i < competencies.reportinfos.scale_competency.length; i++) {\n                        var scaleid = competencies.reportinfos.scale_competency[i].scaleid;\n                        competencies.reportinfos.scale_competency[i].scaleselected = false;\n                        if (scaleid == scaleselected) {\n                            competencies.reportinfos.scale_competency[i].scaleselected = true;\n                        }\n                        var searchvalue = $( '#summary-search-competency-' + scaleid ).val();\n                        competencies.reportinfos.scale_competency[i].tablesearchvalue = searchvalue;\n                    }\n\n                    // Render the \"Summary\" data table template.\n                    templates.render('report_lpmonitoring/summary', competencies).done(function(html, js) {\n                        $(\"#summary-content\").html(html);\n                        templates.runTemplateJS(js);\n                        var popup = new Popup('[data-region=summary-competencies-section]', '[data-user-competency=true]');\n                        // Override the after show refresh method of the user competency popup.\n                        popup._refresh = function() {\n                            var self = this;\n                            learningplan.reloadCompetencyDetail(self._competencyId, self._userId, self._planId);\n                            self.close();\n                        };\n                    });\n                } else {\n                    var competencies = {hascompetencies: false};\n                    templates.render('report_lpmonitoring/summary', competencies).done(function(html, js) {\n                        $(\"#summary-content\").html(html);\n                        templates.runTemplateJS(js);\n                    });\n                }\n            }).fail(\n                function(exp) {\n                    notification.exception(exp);\n                }\n            );\n        };\n\n        /**\n         * Apply inline grader for the rate button.\n         *\n         * @name  applyInlineGrader\n         * @param {Number} competencyid comp ID\n         * @param {Number} userid user ID\n         * @param {Number} planid plan ID\n         * @param {Number} scaleid scale ID\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.applyInlineGrader = function(competencyid, userid, planid, scaleid) {\n            var self = this;\n            str.get_string('chooserating', 'tool_lp').done(\n                function(chooserateoption) {\n                    // Set the inline grader.\n                    var grader = new InlineGrader('#rate_' + competencyid,\n                        scaleid,\n                        competencyid,\n                        userid,\n                        planid,\n                        '',\n                        chooserateoption\n                    );\n                    // Callback when finishing rating.\n                    grader.on('competencyupdated', function() {\n                        self.reloadCompetencyDetail(competencyid, userid, planid);\n                    });\n                }\n            );\n        };\n\n        /**\n         * Reload competency detail and proficiency.\n         *\n         * @name  reloadCompetencyDetail\n         * @param {Number} competencyid Competency ID\n         * @param {Number} userid User ID\n         * @param {Number} planid Plan ID\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.reloadCompetencyDetail = function(competencyid, userid, planid) {\n            var self = this;\n            self.competencies[competencyid] = {};\n            var promise = ajax.call([{\n                methodname: 'core_competency_read_plan',\n                args: { id: planid }\n            }, {\n                methodname: 'report_lpmonitoring_get_competency_detail',\n                args: {\n                    competencyid: competencyid,\n                    userid: userid,\n                    planid: planid\n                }\n            },{\n                methodname: 'report_lpmonitoring_read_plan',\n                args: {\n                    scalevalues: \"\",\n                    templateid: null,\n                    planid: planid,\n                    scalefilterin: self.scalefilterin,\n                    tagid: null,\n                    withcomments: false,\n                    withplans: false\n                }\n            }\n            ]);\n\n            promise[0].then(function(plan) {\n                promise[1].then(function(results) {\n                    // Locally store competency information.\n                    self.competencies[results.competencyid].competencydetail = results;\n                    results.plan = plan;\n                    results.cmcompgradingenabled = self.cmcompgradingEnabled;\n                    templates.render('report_lpmonitoring/competency_detail', results).done(function(html, js) {\n                        $('#comp-' + results.competencyid + ' .x_content').html(html);\n                        templates.runTemplateJS(js);\n                        // Show comptency ratings details tabs.\n                        if (self.compDetailActiveTab === 'incoursemodule') {\n                            $('.detail-comp-tab a[href=\"#tab-incms-content-' + results.competencyid + '\"]').tab('show');\n                        } else {\n                            $('.detail-comp-tab a[href=\"#tab-incourses-content-' + results.competencyid + '\"]').tab('show');\n                        }\n                        if (results.cangrade) {\n                            // Apply inline grader.\n                            self.applyInlineGrader(results.competencyid, userid, planid, results.scaleid);\n                        }\n\n                        // Apply Donut Graph to the competency in courses.\n                        if (results.hasrating !== false) {\n                            self.ApplyDonutGraph(results.competencyid, results, false);\n                        }\n\n                        // Apply Donut Graph to the competency in courses modules.\n                        if (results.hasratingincm !== false && self.cmcompgradingEnabled) {\n                            self.ApplyDonutGraph(results.competencyid, results, true);\n                        }\n                        self.colorContrast.apply('#comp-' + results.competencyid + ' .x_content .tile-stats .badge.cr-scalename');\n                    });\n                    templates.render('report_lpmonitoring/competency_proficiency', results).done(function(html, js) {\n                        $('#comp-' + results.competencyid + ' span.level').html(html);\n                        templates.runTemplateJS(js);\n                    });\n                    // Reload plan stats.\n                    promise[2].then(function(results) {\n                        templates.render('report_lpmonitoring/plan_stats_report',\n                        {\n                            plan:results.plan,\n                            hascompetencies:true\n                        }).done(function(html, js) {\n                            $('#plan-stats-report').html(html);\n                            templates.runTemplateJS(js);\n                        });\n                    });\n                });\n            });\n\n        };\n\n        /**\n         * Apply Donut Grapth to the competency.\n         *\n         * @name   ApplyDonutGraph\n         * @param  {Number} competencyid\n         * @param  {Array} data\n         * @param  {Boolean} forcm\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.ApplyDonutGraph = function(competencyid, data, forcm) {\n            var options = {\n                legend: false,\n                responsive: false,\n                tooltips: {enabled: false}\n            };\n            var colors = [];\n            var canvasselector = '#canvas-graph-' + competencyid;\n            if (forcm) {\n                canvasselector = '#cm-canvas-graph-' + competencyid;\n            }\n\n            var itemsbyscales = [];\n            $.each(data.scalecompetencyitems, function(index, record) {\n                colors.push(record.color);\n                if (forcm) {\n                    itemsbyscales.push(record.nbcm);\n                } else {\n                    itemsbyscales.push(record.nbcourse);\n                }\n            });\n\n            new Chart($(canvasselector), {\n                type: 'doughnut',\n                data: {\n                    labels: [],\n                    datasets: [{\n                        data: itemsbyscales,\n                        backgroundColor: colors,\n                        hoverBackgroundColor: []\n                    }]\n                },\n                options: options\n            });\n        };\n\n        /**\n         * Submit filter form.\n         *\n         * @name   submitFormHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.submitFormHandler = function() {\n            var self = this;\n            var templateSelected = $(\"#template\").is(':checked');\n            var tagSelected = $(\"#tag\").is(':checked');\n            var templateid = null;\n            var planid = null;\n            var tagid = null;\n            if (templateSelected === true) {\n                templateid = self.templateId;\n                planid = self.learningplanId;\n                self.withcomments = $(\"#filter-comment\").is(':checked');\n                self.withplans = $(\"#filter-plan\").is(':checked');\n            } else if (tagSelected === true) {\n                tagid = self.tagId;\n                planid = self.tagLearningplanId;\n            } else {\n                // Else = \"#student\" is selected.\n                planid = self.studentLearningplanId;\n            }\n            self.scalesvaluesSelected = $(self.learningplanSelector).data('scalefilter');\n            if (self.scalefilterin === 'coursemodule') {\n                self.compDetailActiveTab = 'incoursemodule';\n            } else {\n                self.compDetailActiveTab = 'incourse';\n            }\n\n            self.displayPlan(planid, templateid, tagid);\n        };\n\n        /**\n         * Handler on scale change.\n         *\n         * @name   changeScaleHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeScaleHandler = function() {\n            var self = this;\n            var scalefiltervalues = [];\n            $('.competencyreport .scalefiltervalues').each(function () {\n                if ($(this).is(\":checked\")) {\n                    scalefiltervalues.push({scalevalue : $(this).data(\"scalevalue\"), scaleid : $(this).data(\"scaleid\")});\n                }\n            });\n\n            if (scalefiltervalues.length > 0) {\n                $('.competencyreport input[name=optionscalefilter]').prop(\"disabled\", false);\n                $('.competencyreport input[name=optionscalesortorder]').prop(\"disabled\", false);\n\n                if ($(\"#scalefiltercourse\").is(\":not(:checked)\") && $(\"#scalefilterplan\").is(\":not(:checked)\")) {\n                    if (self.cmcompgradingEnabled) {\n                        $('#scalefiltercoursemodule').prop(\"checked\", true);\n                    } else {\n                        $('#scalefiltercourse').prop(\"checked\", true);\n                    }\n                }\n                if ($(\"#scalesortorderasc\").is(\":not(:checked)\") && $(\"#scalesortorderdesc\").is(\":not(:checked)\")) {\n                    $('#scalesortorderasc').prop(\"checked\", true);\n                }\n            } else {\n                $('.competencyreport input[name=optionscalefilter]').prop(\"checked\", false);\n                $('.competencyreport input[name=optionscalefilter]').prop(\"disabled\", true);\n\n                $('.competencyreport input[name=optionscalesortorder]').prop(\"disabled\", true);\n                $('.competencyreport input[name=optionscalesortorder]').prop(\"checked\", false);\n            }\n            self.changeScaleApplyHandler();\n            self.changeScaleSortorderHandler();\n            self.resetUserUsingLPTemplateSelection();\n            var filterscaleinputs = JSON.stringify(scalefiltervalues);\n            $(self.learningplanSelector).data('scalefilter', filterscaleinputs);\n        };\n\n        /**\n         * Handler on scale filter application change.\n         *\n         * @name   changeScaleApplyHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeScaleApplyHandler = function() {\n            var self = this;\n\n            self.scalefilterin = '';\n            if ($(\"#scalefilterplan\").is(':checked')) {\n                self.scalefilterin = '';\n            }\n            if ($(\"#scalefiltercourse\").is(':checked')) {\n                self.scalefilterin = 'course';\n            }\n            if ($(\"#scalefiltercoursemodule\").is(':checked')) {\n                self.scalefilterin = 'coursemodule';\n            }\n            $(self.learningplanSelector).data('scalefilterapply', self.scalefilterin);\n        };\n\n        /**\n         * Handler on scale sort order change.\n         *\n         * @name   changeScaleSortorderHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeScaleSortorderHandler = function() {\n            var self = this;\n            self.scalesortorder = 'ASC';\n            if ($(\"#scalesortorderdesc\").is(':checked')) {\n                self.scalesortorder = 'DESC';\n            }\n            $(self.learningplanSelector).data('scalesortorder', self.scalesortorder);\n        };\n\n        /**\n         * Handler on \"only plans with comments\" filter change.\n         *\n         * @name   changeWithcommentsHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeWithcommentsHandler = function() {\n            var self = this;\n            self.withcomments = $(\"#filter-comment\").is(':checked');\n            $(self.learningplanSelector).data('withcomments', self.withcomments);\n        };\n\n        /**\n         * Handler on \"only students with minimum two plans\" filter change.\n         *\n         * @name   changeWithplansHandler\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.changeWithplansHandler = function() {\n            var self = this;\n            self.withplans = $(\"#filter-plan\").is(':checked');\n            $(self.learningplanSelector).data('withplans', self.withplans);\n        };\n\n        /**\n         * Display the list of evidences in competency.\n         *\n         * @name   displayEvidencelist\n         * @param {Object} evidences Evidence list\n         * @param {Object} trigger element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayEvidencelist = function(evidences, trigger) {\n            var self = this;\n            if (evidences.listevidence.length > 0) {\n                str.get_string('listofevidence', 'tool_lp').done(function(title) {\n                    return ModalFactory.create({\n                        type: ModalFactory.types.DEFAULT,\n                        title: title,\n                        body: templates.render('report_lpmonitoring/list_evidences_in_competency', evidences),\n                        large: true\n                    }).done(function(modal) {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                            self.focusContentItem(trigger);\n                        }.bind(this));\n                        modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                            DataTable.apply('#listevidencecompetency-' + evidences.competencyid, true, true);\n                        }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }).fail(notification.exception);\n            }\n        };\n\n        /**\n         * Display the list of courses in competency.\n         *\n         * @name   displayCourselist\n         * @param {Object[]} listcourses\n         * @param {Object} trigger element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayCourselist = function(listcourses, trigger) {\n            var self = this;\n            if (listcourses.listtotalcourses.length > 0) {\n                str.get_string('linkedcourses', 'tool_lp').done(function(title) {\n                    return ModalFactory.create({\n                        type: ModalFactory.types.DEFAULT,\n                        title: title,\n                        body: templates.render('report_lpmonitoring/list_courses_in_competency', listcourses),\n                        large: true\n                    }).done(function(modal) {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                            self.focusContentItem(trigger);\n                        }.bind(this));\n                        modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                            DataTable.apply('#listcoursecompetency-' + listcourses.competencyid, true, true);\n                        }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }).fail(notification.exception);\n            }\n        };\n\n        /**\n         * Display the list of courses modules in competency.\n         *\n         * @name   displayCmlist\n         * @param {Object[]} listcms\n         * @param {Object} trigger element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayCmlist = function(listcms, trigger) {\n            var self = this;\n            if (listcms.listtotalcms.length > 0) {\n                str.get_string('linkedcms', 'report_lpmonitoring').done(function(title) {\n                    return ModalFactory.create({\n                        type: ModalFactory.types.DEFAULT,\n                        title: title,\n                        body: templates.render('report_lpmonitoring/list_cms_in_competency', listcms),\n                        large: true\n                    }).done(function(modal) {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                            self.focusContentItem(trigger);\n                        }.bind(this));\n                        modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                            DataTable.apply('#listcmcompetency-' + listcms.competencyid, true, true);\n                        }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }).fail(notification.exception);\n            }\n        };\n\n        /**\n         * Display plan.\n         *\n         * @name   displayPlan\n         * @param {Number} planid The learning plan ID\n         * @param {Number} templateid The learning plan template ID\n         * @param {Number} tagid The tag ID\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayPlan = function(planid, templateid, tagid) {\n            var elementloading = null,\n                    self = this;\n            if($('#plan-user-info').length) {\n                elementloading = $('#plan-user-info');\n            } else {\n                elementloading = $(\"#reportFilter button\");\n            }\n            elementloading.addClass('loading');\n            // Hide collapse links as long as the competencies details are not displayed.\n            $('.competencyreport .competency-detail a.collapse-link').css('visibility', 'hidden');\n\n            // Set scales values empty if not defined.\n            self.scalesvaluesSelected = self.userView === false ? self.scalesvaluesSelected : \"\";\n\n            var promise = ajax.call([{\n                methodname: 'report_lpmonitoring_read_plan',\n                args: {\n                    planid: parseInt(planid),\n                    templateid: parseInt(templateid),\n                    scalevalues: self.scalesvaluesSelected,\n                    scalefilterin: self.scalefilterin,\n                    scalesortorder: self.scalesortorder,\n                    tagid: parseInt(tagid),\n                    withcomments: self.withcomments,\n                    withplans: self.withplans\n                }\n            }]);\n            promise[0].then(function(results) {\n                results.templateid = parseInt(templateid);\n                M.cfg.contextid = results.plan.usercontext;\n                if (results.hasnavigation === false) {\n                    $('.plan-info-container').addClass('nonavigation');\n                } else {\n                    $('.plan-info-container').removeClass('nonavigation');\n                }\n                // State of navigation.\n                results.navigationclosed = false;\n                if ($('.plan-info-container').hasClass('closed')) {\n                    results.navigationclosed = true;\n                }\n                if (self.userView === false) {\n                    return templates.render('report_lpmonitoring/user_info', results).done(function(html) {\n                        $(\"#userInfoContainer\").html(html);\n                        self.loadListCompetencies(results.plan, elementloading);\n                        return templates.render('report_lpmonitoring/users_list_navigation', results).done(function(html) {\n                            $(\"#users-list-full-navigation\").html(html);\n                        });\n                    });\n                } else {\n                    str.get_string('learningplancompetencies', 'report_lpmonitoring', results.plan.name).done(function(planname) {\n                        $('#planInfoContainer h3').text(planname);\n                        self.loadListCompetencies(results.plan, elementloading);\n                    });\n                }\n            }).fail(\n                    function(exp) {\n                        elementloading.removeClass('loading');\n                        if (exp.errorcode === 'emptytemplate') {\n                            var exception = {exception:exp};\n                            return templates.render('report_lpmonitoring/user_info', exception).done(function(html) {\n                                $(\"#userInfoContainer\").html(html);\n                                $(\"#listPlanCompetencies\").empty();\n                                $(\"#plan-stats-report\").empty();\n                                $(\"#report-content\").empty();\n                                $(\"#summary-content\").empty();\n                                $(\"#nav-tabs\").hide();\n                                $(\"#users-list-full-navigation\").empty();\n                            });\n                        } else {\n                            notification.exception(exp);\n                        }\n                    }\n                );\n        };\n\n        /**\n         * Display the list of courses in competency.\n         *\n         * @name   displayScaleCourseList\n         * @param {Object[]} listcourses list of courses\n         * @param {Object} trigger element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayScaleCourseList = function(listcourses, trigger) {\n            var self = this;\n            if (listcourses.scalecompetencyitem.listcourses.length > 0) {\n                str.get_string('linkedcourses', 'tool_lp').done(function(title) {\n                    return ModalFactory.create({\n                        type: ModalFactory.types.DEFAULT,\n                        title: title,\n                        body: templates.render('report_lpmonitoring/list_courses_in_scale_value', listcourses),\n                        large: true\n                    }).done(function(modal) {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                            self.focusContentItem(trigger);\n                        }.bind(this));\n                        modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                            DataTable.apply('#listscalecoursecompetency-' + listcourses.competencyid, true, true);\n                            self.colorContrast.apply('.moodle-dialogue-base .badge.cr-scalename');\n                        }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }).fail(notification.exception);\n            }\n        };\n\n        /**\n         * Display the list of courses modules in competency.\n         *\n         * @name   displayScaleCmList\n         * @param {Object[]} listitems\n         * @param {Object} trigger element\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.displayScaleCmList = function(listitems, trigger) {\n            var self = this;\n            if (listitems.scalecompetencyitem.listcms.length > 0) {\n                str.get_string('linkedcms', 'report_lpmonitoring').done(function(title) {\n                    return ModalFactory.create({\n                        type: ModalFactory.types.DEFAULT,\n                        title: title,\n                        body: templates.render('report_lpmonitoring/list_cms_in_scale_value', listitems),\n                        large: true\n                    }).done(function(modal) {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                            self.focusContentItem(trigger);\n                        }.bind(this));\n                        modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                            DataTable.apply('#listscalecmcompetency-' + listitems.competencyid, true, true);\n                            self.colorContrast.apply('.moodle-dialogue-base .badge.cr-scalename');\n                        }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }).fail(notification.exception);\n            }\n        };\n\n        /**\n         * Focus the given content item or the first focusable element within\n         * the content item.\n         *\n         * @method focusContentItem\n         * @param {object} item The content item jQuery element\n         */\n        LearningplanReport.prototype.focusContentItem = function(item) {\n            var focusable = 'input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]';\n            if (item.is(focusable)) {\n                item.focus();\n            } else {\n                item.find(focusable).first().focus();\n            }\n        };\n\n        /**\n         * Reset grade for one competency.\n         *\n         * @name   resetGrade\n         * @param  {Number} planid\n         * @param  {Number} userid\n         * @param  {Number} competencyid or null for all competencies of this plan\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.resetGrade = function(planid, userid, competencyid) {\n            var self = this;\n            var allcompetencies = false;\n            if (competencyid === null) {\n                allcompetencies = true;\n            }\n            var dialogue = new ResetGradeDialogue(allcompetencies);\n            dialogue.on('rated', function(e, data) {\n                var promise = ajax.call([{\n                    methodname: 'report_lpmonitoring_reset_grading',\n                    args: {\n                        planid: planid,\n                        competencyid: competencyid,\n                        note: data.note\n                    }\n                }]);\n\n                promise[0].then(function() {\n                    if (competencyid === null) {\n                        self.displayPlan(planid, self.templateId, self.tagId);\n                    } else {\n                        self.reloadCompetencyDetail(competencyid, userid, planid);\n                    }\n                }).fail(\n                    function(exp) {\n                        notification.exception(exp);\n                    }\n                );\n            });\n            dialogue.display();\n        };\n\n        /**\n         * Init the differents page blocks and inputs form.\n         *\n         * @name   initPage\n         * @return {Void}\n         * @function\n         */\n        LearningplanReport.prototype.initPage = function() {\n            var self = this;\n            str.get_strings([\n                { key: 'selectuser', component: 'report_lpmonitoring' },\n                { key: 'nouserselected', component: 'report_lpmonitoring' }]\n            ).done(\n                function (strings) {\n                    // Autocomplete users in templates.\n                    autocomplete.enhance(\n                        self.learningplanSelector,\n                        false,\n                        'report_lpmonitoring/learningplan',\n                        strings[0],\n                        false,\n                        true,\n                        strings[1]);\n                    // Autocomplete users.\n                    autocomplete.enhance(\n                        self.studentSelector,\n                        false,\n                        'tool_lp/form-user-selector',\n                        strings[0],\n                        false,\n                        true,\n                        strings[1]);\n                    if (self.userView === false) {\n                        if ($('.competencyreport #student').is(':checked')) {\n                            $('.competencyreport .templatefilter').toggleClass('disabled-option', true);\n                            $('.competencyreport .tagfilter').toggleClass('disabled-option', true);\n                        } else if ($('.competencyreport #tag').is(':checked')) {\n                            $('.competencyreport .studentfilter').toggleClass('disabled-option', true);\n                            $('.competencyreport .templatefilter').toggleClass('disabled-option', true);\n                        } else {\n                            $('.competencyreport .studentfilter').toggleClass('disabled-option', true);\n                            $('.competencyreport .tagfilter').toggleClass('disabled-option', true);\n                        }\n                    }\n                    self.checkDataFormReady();\n                }\n            ).fail(notification.exception);\n            $(\".competencyreport\").on('click', '.moreless-toggler', function(event) {\n                event.preventDefault();\n                $(\".advanced\").toggle();\n                $(this).toggleClass(\"hidden\").siblings().removeClass('hidden');\n            });\n\n            // Allow collapse of block panels.\n            fieldsettoggler.init();\n\n            // Collapse block panels.\n            $(\".competencyreport\").on('click', '.collapse-link', function(event) {\n                event.preventDefault();\n                var e = $(this).closest(\".x_panel\"),\n                t = $(this).find(\"i\"),\n                n = e.find(\".x_content\");\n                t.toggleClass(\"fa-chevron-right fa-chevron-down\");\n                n.slideToggle();\n                e.toggleClass(\"panel-collapsed\");\n            });\n\n            // Handle click on scale number courses.\n            $(\".competencyreport\").on('click', 'a.scaleinfo', function(event) {\n                event.preventDefault();\n                var trigger = $(event.target).closest('td');\n                var competencyid = $(this).data(\"competencyid\");\n                var scalevalue = $(this).data(\"scalevalue\");\n                var type = $(this).data(\"type\");\n\n                if (typeof self.competencies[competencyid] !== 'undefined') {\n                    var listitems = {};\n                    var competencydetail = self.competencies[competencyid].competencydetail;\n                    listitems.scalecompetencyitem = competencydetail.scalecompetencyitems[scalevalue - 1];\n                    listitems.competencyid = competencyid;\n                    if (type === 'incm') {\n                        self.displayScaleCmList(listitems, trigger);\n                    } else {\n                        self.displayScaleCourseList(listitems, trigger);\n                    }\n                }\n            });\n\n            $('.competencyreport #student').on('change', function(){\n                if ($(this).is(':checked')){\n                    $('.competencyreport .studentfilter').toggleClass('disabled-option', false);\n                    $('.competencyreport .templatefilter').toggleClass('disabled-option', true);\n                    $('.competencyreport .tagfilter').toggleClass('disabled-option', true);\n                }\n                self.checkDataFormReady();\n            });\n\n            $('.competencyreport #template').on('change', function(){\n                if ($(this).is(':checked')){\n                    $('.competencyreport .studentfilter').toggleClass('disabled-option', true);\n                    $('.competencyreport .templatefilter').toggleClass('disabled-option', false);\n                    $('.competencyreport .tagfilter').toggleClass('disabled-option', true);\n                }\n                self.checkDataFormReady();\n            });\n\n            $('.competencyreport #tag').on('change', function(){\n                if ($(this).is(':checked')){\n                    self.loadTags();\n                    $('.competencyreport .studentfilter').toggleClass('disabled-option', true);\n                    $('.competencyreport .templatefilter').toggleClass('disabled-option', true);\n                    $('.competencyreport .tagfilter').toggleClass('disabled-option', false);\n                }\n                self.checkDataFormReady();\n            });\n\n            // Filter form submit.\n            $(document).on('submit', '#reportFilter', function(){\n                self.submitFormHandler();\n                return false;\n            });\n\n            // User plan navigation.\n            $(\".competencyreport\").on('click', 'a.navigatetoplan', function(event) {\n                event.preventDefault();\n                var planid = $(this).data('planid');\n                var templateid = $(this).data('templateid');\n                var tagid = $(this).data('tagid');\n                self.displayPlan(planid, templateid, tagid);\n            });\n\n            // User plan full navigation.\n            $(\".competencyreport\").on('click', '.toggle-lp-list-users', function(event) {\n                event.preventDefault();\n                $(this).find('i.angle').toggleClass('fa-angle-double-right fa-angle-double-left');\n                $(this).closest('.plan-info-container').toggleClass('closed');\n                $('div[data-region=\"blocks-lp-list-users\"]').toggleClass('lp-list-users-closed');\n            });\n            var tmpselector = '.plan-info-container .table-list-users .nav-list-users-displayinfo';\n            $(\".competencyreport\").on('click', tmpselector, function(event) {\n                event.stopPropagation();\n                event.preventDefault();\n                $(this).find('i.fa').toggleClass('fa-angle-down fa-angle-up');\n                $(this).parent().find('span.item-nav-list-users-info').toggleClass('hidden');\n            });\n            $(\".competencyreport\").on('click', '.plan-info-container .table-list-users tr', function(event) {\n                event.preventDefault();\n                var planid = $(this).data('planid');\n                var templateid = $(this).data('templateid');\n                var tagid = $(this).data('tagid');\n                self.displayPlan(planid, templateid, tagid);\n            });\n\n            // Handle click on list evidence.\n            $(\".competencyreport\").on('click', 'a.listevidence', function(event) {\n                event.preventDefault();\n                var trigger = $(event.target);\n                var competencyid = $(this).data('competencyid');\n                if (typeof self.competencies[competencyid] !== 'undefined') {\n                    var listevidence = {};\n                    listevidence.listevidence = self.competencies[competencyid].competencydetail.listevidence;\n                    listevidence.competencyid = competencyid;\n                    self.displayEvidencelist(listevidence, trigger);\n                }\n            });\n\n            // Handle click on total number courses.\n            $(\".competencyreport\").on('click', 'a.totalnbcourses', function(event) {\n                event.preventDefault();\n                var trigger = $(event.target);\n                var competencyid = $(this).data('competencyid');\n                if (typeof self.competencies[competencyid] !== 'undefined') {\n                    var totallistcourses = {};\n                    totallistcourses.listtotalcourses = self.competencies[competencyid].competencydetail.listtotalcourses;\n                    totallistcourses.competencyid = competencyid;\n                    self.displayCourselist(totallistcourses, trigger);\n                }\n            });\n\n            // Handle click on total number of courses modules.\n            $(\".competencyreport\").on('click', 'a.totalnbcms', function(event) {\n                event.preventDefault();\n                var trigger = $(event.target);\n                var competencyid = $(this).data('competencyid');\n                if (typeof self.competencies[competencyid] !== 'undefined') {\n                    var totallistcms = {};\n                    totallistcms.listtotalcms = self.competencies[competencyid].competencydetail.listtotalcms;\n                    totallistcms.competencyid = competencyid;\n\n                    self.displayCmlist(totallistcms, trigger);\n                }\n            });\n            // Handle click on rating tabs.\n            $(\".competencyreport\").on('click', '.detail-comp-tab a', function(event) {\n                event.preventDefault();\n                if ($(event.target).hasClass('incm')) {\n                    self.compDetailActiveTab = \"incoursemodule\";\n                } else {\n                    self.compDetailActiveTab = \"incourse\";\n                }\n            });\n\n            // Handle click on reset display rating.\n            $(\".competencyreport\").on('click', '.resetdisplayrating a', function(event) {\n                event.preventDefault();\n                var planid = $(this).data('canresetdisplayrating-plan');\n                self.resetDisplayRating(planid);\n            });\n\n            // Handle click on reset one competency.\n            $(\".competencyreport\").on('click', '.reset-grade a', function(event) {\n                event.preventDefault();\n                var planid = $(this).data('resetgrade-plan');\n                var competencyid = $(this).data('competencyid');\n                var userid = $(this).data('userid');\n                self.resetGrade(planid, userid, competencyid);\n            });\n\n            // Handle click on reset all competencies.\n            $(\".competencyreport\").on('click', '.reset-grade-all a', function(event) {\n                event.preventDefault();\n                var planid = $(this).data('resetgrade-plan');\n                var userid = $(this).data('userid');\n                self.resetGrade(planid, userid, null);\n            });\n\n            // Collapse/Expand all.\n            str.get_strings([\n                { key: 'collapseall'},\n                { key: 'expandall'}]\n            ).done(\n                function (strings) {\n                    var collapseall = strings[0];\n                    var expandall = strings[1];\n                    $(\".competencyreport\").on('click', '.collapsible-actions a', function(event) {\n                        event.preventDefault();\n                        if ($(this).hasClass('collapse-all')) {\n                            $(this).text(expandall);\n                            $('#listPlanCompetencies div.x_panel:not(.panel-collapsed) a.collapse-link').trigger('click');\n                        } else {\n                            $(this).text(collapseall);\n                            $('#listPlanCompetencies div.panel-collapsed a.collapse-link').trigger('click');\n                        }\n                        $(this).toggleClass(\"collapse-all expand-all\");\n                    });\n                }\n            ).fail(notification.exception);\n        };\n\n        return {\n            /**\n             * Main initialisation.\n             *\n             * @param {Boolean} userview True if the report is for user view (student).\n             * @param {Boolean} cmcompgradingenabled True if grading in course module competency is enabled.\n             * @return {LearningplanReport} A new instance of LearningplanReport.\n             * @method init\n             */\n            init: function(userview, cmcompgradingenabled) {\n                return new LearningplanReport(userview, cmcompgradingenabled);\n            },\n            /**\n             * Process result autocomplete.\n             *\n             * @param {type} selector\n             * @param {type} results\n             * @returns {Array}\n             */\n            processResults: function(selector, results) {\n                var users = [];\n                $.each(results, function(index, userplan) {\n                    users.push({\n                        value: userplan.planid,\n                        label: userplan._label\n                    });\n                });\n                return users;\n            },\n\n            /**\n             * Transport method for autocomplete.\n             *\n             * @param {type} selector\n             * @param {type} query\n             * @param {type} success\n             * @param {type} failure\n             * @returns {undefined}\n             */\n            transport: function(selector, query, success, failure) {\n                var promise;\n                var scalefilterapply = $(selector).data('scalefilterapply');\n                var scalesortorder = $(selector).data('scalesortorder');\n                scalesortorder = scalesortorder ? scalesortorder : 'ASC';\n                var withcomments = $(selector).data('withcomments');\n                withcomments = withcomments ? withcomments : false;\n                var withplans = $(selector).data('withplans');\n                withplans = withplans ? withplans : false;\n                var templateid = $(selector).data('templateid');\n                if (templateid === '') {\n                    return [];\n                }\n\n                promise = ajax.call([{\n                    methodname: 'report_lpmonitoring_search_users_by_templateid',\n                    args: {\n                        query: query,\n                        templateid: parseInt(templateid),\n                        scalevalues: $(selector).data('scalefilter'),\n                        scalefilterin: scalefilterapply,\n                        scalesortorder: scalesortorder,\n                        withcomments: withcomments,\n                        withplans: withplans\n                    }\n                }]);\n\n                promise[0].then(function(results) {\n                    var promises = [],\n                        i = 0;\n                    // Render the label.\n                    $.each(results, function(index, user) {\n                        var ctx = user,\n                            identity = [];\n                        $.each(['idnumber', 'email', 'phone1', 'phone2', 'department', 'institution'], function(i, k) {\n                            if (typeof user[k] !== 'undefined' && user[k] !== '') {\n                                ctx.hasidentity = true;\n                                identity.push(user[k]);\n                            }\n                        });\n                        ctx.identity = identity.join(', ');\n                        promises.push(templates.render('report_lpmonitoring/form-user-selector-suggestion', ctx));\n                    });\n\n                    // Apply the label to the results.\n                    return $.when.apply($.when, promises).then(function() {\n                        var args = arguments;\n                        $.each(results, function(index, user) {\n                            user._label = args[i];\n                            i++;\n                        });\n                        success(results);\n                    });\n\n                }, failure);\n            }\n        };\n\n    });"],"file":"learningplan.min.js"}